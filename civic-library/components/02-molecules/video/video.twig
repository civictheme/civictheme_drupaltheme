{#
/**
 * @file
 * Video component.
 *
 * Variables:
 * - theme: [string] Theme: light, dark.
 * - title: [string] Title for the iframe.
 * - src: [string] URL of the video.
 * - width: [string] Width of the iframe.
 * - height: [string] Height of the video.
 * - transcript_link: [object] Video transcript link.
 * - share_link: [object] Video share link.
 * - oembed: [string] oEmbed provided iframe container.
 * - modifier_class: [string] Additional classes.
 *
 * @todo Refactor into Video atom (plain video) and Video Molecule (with links).
 */
#}

{% set theme_class = 'civic-theme-%s'|format(theme|default('light')) %}
{% set modifier_class = '%s %s'|format(theme_class, modifier_class|default('')) %}

{% set transcript_link_title = transcript_link.title|default('Opens in a new tab') %}
{% set transcript_link_external = transcript_link.external|default(false) %}
{% set share_link_title = share_link.title|default('Opens in a new tab') %}
{% set share_link_external = share_link.external|default(false) %}

{% if src is not empty or oembed is not empty %}
  <div class="civic-video {{ modifier_class }}">
    {% block video %}
      <div class="civic-video__wrapper">
        {% if oembed is not empty %}
          {{ oembed|raw }}
        {% else %}
          {% set attributes = 'allowfullscreen data-chromatic="ignore"' %}
          {% if title is not empty %}
            {% set attributes = atributes ~ 'title="' ~ title ~ '"' %}
          {% endif %}
          {% include '@atoms/iframe/iframe.twig' with {
            height: height,
            width: width,
            url: src,
            attributes: attributes,
            modifier_class: 'civic-video__action-icon',
          } only %}
        {% endif %}
      </div>
    {% endblock %}

    {% block links %}
      <div class="civic-video__links">
        {% if transcript_link.url is defined and transcript_link.url is not empty %}
          <div class="civic-video__links__transcript">
            {% include '@atoms/icon/icon.twig' with {
              symbol: 'designtools_eye',
              color: 'shade_dark_15',
              modifier_class: 'civic-video__action-icon',
            } only %}
            {% include '@atoms/link/link.twig' with {
              theme: theme,
              text: transcript_link.text,
              title: transcript_link.title,
              url: transcript_link.url,
              new_window: transcript_link.new_window,
              is_external: transcript_link.is_external,
              attributes: transcript_link.attributes
            } only %}
          </div>
        {% endif %}

        {% if share_link.url is defined and share_link.url is not empty %}
          <div class="civic-video__links__share">
            {% include '@atoms/icon/icon.twig' with {
              symbol: 'userinterface_share',
              modifier_class: 'civic-video__action-icon',
            } only %}
            {% include '@atoms/link/link.twig' with {
              theme: theme,
              text: share_link.text,
              title: share_link.title,
              url: share_link.url,
              new_window: share_link.new_window,
              is_external: share_link.is_external,
              attributes: share_link.attributes
            } only %}
          </div>
        {% endif %}
      </div>
    {% endblock %}
  </div>
{% endif %}

